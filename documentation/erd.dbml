enum feedback_type {
  general
  bug
  feature_request
  other
}

// ðŸ”‘
Table feedback {
  id varchar(50) [pk, unique, default: `uuid_generate_v4()`]
  email varchar(255)
  description text
  feedback_type feedback_type [not null, default: 'general']

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp
}

// ðŸ”‘
Table contact_us {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  first_name varchar(255) [not null]
  last_name varchar(255) [not null]
  email varchar(255) [not null]
  contact_number varchar(20) [not null]
  description varchar(1024)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp
}

// ðŸ”‘
Table subscription_plan {
  id varchar(50) [pk, unique, default: `uuid_generate_v4()`]
  name varchar(255) [not null, unique]
  description text
  cost integer [not null]
  timespan integer [default: 1209600000] // 14 days in ms
  max_employees integer [not null, default: 3]
  max_members_per_branch integer [not null, default: 10]
  max_branches integer [not null, default: 1]
  discount decimal(5,2) [default: 0]
  yearly_discount decimal(5,2) [default: 0]

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp
}

enum notification_type {
  info
  report
}
  
// ðŸ”‘
Table notification {
  id varchar(50) [pk, unique, default: `uuid_generate_v4()`]
  user_id varchar(50)

  title varchar(255)
  description varchar(1024) [not null]
  notification_type notification_type [default: 'info']
  is_viewed boolean [default: false]

  created_by_id varchar(50) [ref: - user.id]
  created_at timestamp [not null, default: `now()`]
}

Ref: notification.user_id > user.id [delete: cascade, update: cascade]

enum user_type {
  owner
  employee
  member
  ban
}

Table user {
  id varchar(50) [pk, unique, default: `uuid_generate_v4()`]

  media_id varchar(50)
  api_key varchar(255) [not null, unique]
  password varchar(255) [not null]
  birthdate date

  user_name varchar(255) [not null, unique]
  first_name varchar(255)
  middle_name varchar(255)
  last_name varchar(255)
  full_name varchar(255) [note: 'can be computed client-side']
  suffix varchar(50)

  email varchar(255) [not null, unique]
  is_email_verified boolean [default: false]

  contact_number varchar(20) [not null, unique]
  is_contact_verified boolean [default: false]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp
}

Ref: user.media_id - media.id [delete: set null]

// ðŸ”‘
Table user_settings {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  description text

  start_or integer
  end_or integer
  used_or integer

  start_voucher integer
  end_voucher integer
  used_voucher integer

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: user_settings.organization_id > organization.id [delete: cascade, update: cascade]
Ref: user_settings.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘

Table user_role {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  branch_id varchar(50)

  user_id varchar(50)
  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  name varchar(255)// possible values: teller, book keeper, manager, collector
  description text
  permissions "varchar[]" [default: "['read:owner_dashboard']"]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    branch_id
  }

}

Ref: user_role.branch_id > branch.id [delete:cascade, update:cascade]
Ref: user_role.user_id > user.id [delete:cascade, update:cascade]

Table media {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]
  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  user_type user_type

  description text
  file_name varchar(255) [not null]
  file_size integer [not null]
  file_type varchar(255) [not null]
  storage_key varchar(255) [not null]
  bucket_name varchar(255) [not null]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    created_by_id [name:'created_by_user']
  }

}

enum report_status {
  pending
  completed
  canceled
  error
}

// ðŸ”‘
Table generated_reports {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  branch_id varchar(50)
  organization_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]
  requested_by_user_id varchar(50)
  media_id varchar(50)

  name varchar(255) [not null]
  description text
  progress decimal [default: 0]
  password varchar(255)

  status generated_report_status [default: "pending"]

  started_at timestamp [not null, default: `now()`]
  finished_at timestamp

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id ) [name: 'organization_branch']
  }

}

Ref: generated_reports.organization_id > organization.id [delete:cascade, update:cascade]
Ref: generated_reports.branch_id > branch.id [delete:cascade, update:cascade]
Ref: generated_reports.media_id - media.id
Ref: generated_reports.requested_by_user_id - user.id

enum organization_migration_status {
  pending
  migrating
  seeding
  completed
  canceled
  error
}

// ðŸ”‘
Table organization {
  id varchar(50) [pk, unique, default: `uuid_generate_v4()`]
  media_id varchar(50)
  cover_media_id varchar(50)

  org_key varchar(255) [not null, unique]
  name varchar(255) [not null, unique]
  description text

  subscription_plan_id varchar(50)
  subscription_start_date timestamp
  subscription_end_date timestamp

  database_host varchar(255)
  database_port varchar(10)
  database_name varchar(255)
  database_username varchar(255)
  database_password varchar(255)
  database_migration_status organization_migration_status
  database_remarks text

  email varchar(255) [not null, unique]
  contact_number varchar(20) [not null, unique]
  is_contact_verified boolean [default: false]

  color varchar(50)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp
}

Ref: organization.media_id - media.id [delete: set null, update: cascade]
Ref: organization.cover_media_id - media.id [delete: set null, update: cascade]
Ref: organization.subscription_plan_id > subscription_plan.id [delete: restrict, update: cascade]

// Tracking usage
// Coop Usage entries Per Day ( this is system generated )
// ðŸ”‘
Table organization_daily_usage {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  date date [not null, default: `current_date`]

  employees integer [default: 0]
  members integer [default: 0]
  branches integer [default: 0]

  cash_transaction_count integer [default: 0]
  check_transaction_count integer [default: 0]
  online_transaction_count integer [default: 0]

  cash_transaction_amount decimal [default: 0]
  check_transaction_amount decimal [default: 0]
  online_transaction_amount decimal [default: 0]

  total_email_sent integer
  total_message_sent integer
  total_upload_size integer // bytes
  total_report_render_time decimal

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp
}

Ref: organization_daily_usage.organization_id > organization.id [delete: set null, update: cascade]

// 1. Pang Accept
// 2. Pang
// ðŸ”‘
Table user_organization {
  id varchar(50) [pk, unique, default: `uuid_generate_v4()`]
  user_id varchar(50)

  branch_id varchar(50)
  organization_id varchar(50)

  user_type user_type [not null]
  accepted_at timestamp
  reviewing_at timestamp
  rejected_at timestamp
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch', unique]
  }

}

Ref: user_organization.user_id > user.id [delete: restrict, update: cascade]
Ref: user_organization.organization_id > organization.id [delete: cascade, update: cascade]

enum branch_type {
  "cooperative branch"
  "business branch"
  "banking branch"
}

// ðŸ”‘
Table branch {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  media_id varchar(50)
  type branch_type [not null, default: "cooperative branch"]
  country_code varchar(5)

  // Favorite/star
  is_main_branch boolean [not null, default: false]

  name varchar(255)
  description text
  address varchar(500)
  province varchar(255)
  postal_code varchar(20)
  city varchar(255)
  email varchar(255)
  region varchar(255)
  barangay varchar(255)
  contact_number varchar(15)
  is_admin_verified boolean [default: false]

  latitude decimal(10,7)
  longitude decimal(10,7)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    organization_id
  }

}

Ref: branch.organization_id > organization.id [delete: cascade, update: cascade]
Ref: branch.media_id - media.id [delete:cascade]

// TEMPLATE
// ðŸ”‘
Table role_template {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  name varchar(255)// possible template name: teller, book keeper, manager, collector)
  description text
  permissions "varchar[]" [default: "[]"]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name:'organization_branch']
  }

}

Ref: role_template.organization_id > organization.id [delete: cascade, update: cascade]
Ref: role_template.branch_id > branch.id [delete:cascade, update:cascade]

// ---- EMPLOYEE RATING FEATURE ---- //
// ðŸ”‘
Table user_rating {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  ratee_user_id varchar(50)
  rater_user_id varchar(50)

  rate integer
  remark varchar(4028)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: user_rating.organization_id > organization.id [delete: cascade, update: cascade]
Ref: user_rating.branch_id > branch.id [delete:cascade, update:cascade]
Ref: user_rating.ratee_user_id - user.id [delete: cascade, update: cascade]
Ref: user_rating.rater_user_id - user.id [delete: cascade, update: cascade]

// ---- EMPLOYEE RATING FEATURE END ---- //

// ðŸ”‘
Table user_branch_allowed {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]
  user_id varchar(50)

  is_default boolean [default: false]

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  branch_id varchar(50)
  organization_id varchar(50)

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: user_branch_allowed.user_id > user.id [delete:cascade, update:cascade]
Ref: user_branch_allowed.branch_id - branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table invitation_code {
  id varchar(50) [pk, unique, default: `uuid_generate_v4()`]

  branch_id varchar(50)
  organization_id varchar(50)

  user_type user_type [not null]
  code varchar(50) [not null, unique]
  expiry_date timestamp
  max_use integer [default: -1] // -1 = unlimited
  current_use integer [default: 0]

  created_by varchar(50) [ref: - user.id]
  updated_by varchar(50) [ref: - user.id]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: invitation_code.organization_id > organization.id [delete: cascade, update:cascade]
Ref: invitation_code.branch_id > branch.id [delete: cascade, update:cascade]

Enum family_relationship {
  "father"
  "mother"
  "son"
  "daughter"
  "brother"
  "sister"
  "husband"
  "wife"
  "partner"
  "grandfather"
  "grandmother"
  "grandson"
  "granddaughter"
  "stepfather"
  "stepmother"
  "stepson"
  "stepdaughter"
  "half-brother"
  "half-sister"
  "foster father"
  "foster mother"
  "foster son"
  "foster daughter"
  "guardian"
  "uncle"
  "aunt"
  "nephew"
  "niece"
  "cousin"
  "father-in-law"
  "mother-in-law"
  "son-in-saw"
  "daughter-in-law"
  "brother-in-daw"
  "sister-in-law"
  "godfather"
  "godmother"
  "godson"
  "goddaughter"
  "adopted son"
  "adopted daughter"
  "ward"
  "other"
}

enum civil_status {
  married
  single
  widowed
  divorced
  separated
  "civil partnership"
}

enum sex {
  male
  female
}

enum general_status {
  pending
  "for review"
  verified
  "not allowed"
}

// ðŸ”‘
Table member_verification {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  branch_id varchar(50)
  organization_id varchar(50)

  member_profile_id varchar(50)
  verified_by_user_id varchar(50)
  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  status general_status [not null, default: "pending"]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization-branch']
  }
}

Ref: member_verification.branch_id - branch.id [delete:cascade, update:cascade]
Ref: member_verification.organization_id > organization.id [delete:cascade, update:cascade]

// Ref: member_verification.member_profile_id - member_profile.id [delete:cascade, update:cascade]
Ref: member_verification.verified_by_user_id - user.id [delete:cascade, update:cascade]

//----------- MAINTENANCE TABLE -----------//

// ðŸ”‘
Table member_center {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]
  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  branch_id varchar(50)
  organization_id varchar(50)

  name varchar(255)
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization-branch']
  }

}

Ref: member_center.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_center.organization_id > organization.id [delete:cascade, update:cascade]

// ðŸ”‘
Table member_classification {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  branch_id varchar(50)
  organization_id varchar(50)

  name varchar(255) [not null] // ex: Bronze, Silver, Gold
  icon varchar(255)
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_classification.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_classification.organization_id > organization.id [delete: cascade, update: cascade]

// ðŸ”‘
Table member_gender {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  branch_id varchar(50)
  organization_id varchar(50)

  name varchar(255)
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_gender.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_gender.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table member_group {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  branch_id varchar(50)
  organization_id varchar(50)

  name varchar(50) [not null]
  description text [not null]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_group.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_group.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table member_occupation {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]
  branch_id varchar(50)
  organization_id varchar(50)

  name varchar(255)
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_occupation.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_occupation.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table member_type {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]
  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]
  branch_id varchar(50)
  organization_id varchar(50)

  prefix varchar(255)
  name varchar(255)
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_type.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_type.branch_id > branch.id [delete:cascade, update:cascade]

//----------- MAINTENANCE TABLE END -----------//

// ðŸ”‘
Table member_profile {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  branch_id varchar(50)
  organization_id varchar(50)

  media_id varchar(50)
  signature_media_id varchar(50)

  user_id varchar(50)
  member_type_id varchar(50)
  member_group_id varchar(50)
  member_gender_id varchar(50)
  member_center_id varchar(50)
  member_occupation_id varchar(50)
  member_classification_id varchar(50)
  member_verified_by_employee_user_id varchar(50)
  recruited_by_member_profile_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  is_closed boolean [default: false] // this indicates the member account has been closed
  is_mutual_fund_member boolean [default: false]
  is_micro_finance_member boolean [default: false]

  first_name varchar(255) [not null]
  middle_name varchar(255)
  last_name varchar(255) [not null]
  full_name varchar(255) [not null]
  suffix varchar(50)
  birthdate date
  status general_status [not null, default: "pending"]

  description text
  notes text
  contact_number varchar(255)
  old_reference_id varchar(50) // this is not ref Id, just the old PB number
  passbook varchar(255)
  occupation varchar(255)
  business_address varchar(255)
  business_contact_number varchar(255)
  civil_status civil_status [not null, default: "single"]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    full_name
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_profile.member_verified_by_employee_user_id > user.id [delete:set null, update:cascade]
Ref: member_profile.user_id - user.id [delete:restrict, update:cascade]
Ref: member_profile.media_id - media.id [delete:set null, update:cascade]
Ref: member_profile.signature_media_id - media.id [delete:set null, update:cascade]
Ref: member_profile.branch_id < branch.id [delete:restrict, update:cascade]
Ref: member_profile.recruited_by_member_profile_id - member_profile.id [delete:restrict, update:cascade]
Ref: member_profile.member_occupation_id - member_occupation.id [delete:restrict, update:cascade]
Ref: member_profile.member_gender_id - member_gender.id [delete:restrict, update:cascade]
Ref: member_profile.member_center_id - member_center.id [delete:restrict, update:cascade]
Ref: member_profile.member_type_id - member_type.id [delete:restrict, update:cascade]
Ref: member_profile.member_classification_id - member_classification.id [delete:restrict, update:cascade]
Ref: member_profile.member_group_id - member_group.id [delete:restrict, update:cascade]

// ðŸ”‘
Table member_close_remark {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  member_profile_id varchar(50)
  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  branch_id varchar(50)
  organization_id varchar(50)

  reason varchar(255)
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_close_remark.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_close_remark.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_close_remark.member_profile_id > member_profile.id [delete:restrict, update:cascade]

enum address_types {
  "home"
  "business address"
  "work address"
  "shipping address"
  "billing address"
  "mailing address"
  "previous address"
  "emergency contact address"
  "vacation home"
  "other..."
}

// ðŸ”‘
Table member_address {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]
  branch_id varchar(50)
  organization_id varchar(50)

  member_profile_id varchar(50)
  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  label varchar(255) [not null, default: "home"] // Home Address, Business Address, Home Address 2
  city varchar(255) [not null]
  country_code varchar(5) [not null]
  postal_code varchar(255)
  province_state varchar(255) //accomodates province or state

  barangay varchar(255) // for ph country only

  landmark varchar(255)
  address varchar(255) [not null]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_address.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_address.organization_id > organization.id [delete:cascade, update:cascade]

// ðŸ”‘
// NOTE: This also include the vehicle from Old coop sys
Table member_asset {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  branch_id varchar(50)
  organization_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  media_id varchar(50)
  member_profile_id varchar(50)

  name varchar(255) [not null]
  entry_date timestamp [not null]
  description text [not null]
  cost decimal [default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization-branch']
  }

}

Ref: member_asset.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_asset.organization_id > organization.id [delete:restrict, update:cascade]

Ref: member_asset.media_id - media.id [delete:cascade, update:cascade]
Ref: member_asset.member_profile_id > member_profile.id [delete:restrict, update:cascade]


// ðŸ”‘
Table member_contact_reference {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  member_profile_id varchar(50)
  branch_id varchar(50)
  organization_id varchar(50)

  name varchar(255)
  description text
  contact_number varchar(30)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_contact_reference.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_contact_reference.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_contact_reference.member_profile_id > member_profile.id [delete:restrict, update:cascade]

// ðŸ”‘
Table member_educational_attainment {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  member_profile_id varchar(50)
  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  branch_id varchar(50)
  organization_id varchar(50)

  name varchar(255) [not null]
  school_name varchar(255)
  school_year integer
  program_course varchar(255)
  educational_attainment varchar(255) // TODO: Frontend enum dropdown - Bachelors Degree, Phd, Masteral
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_educational_attainment.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_educational_attainment.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_educational_attainment.member_profile_id > member_profile.id [delete:restrict, update:cascade]

// ðŸ”‘
Table member_expense {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  member_profile_id varchar(50)
  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  branch_id varchar(50)
  organization_id varchar(50)

  name varchar(255)
  amount decimal
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_expense.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_expense.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_expense.member_profile_id > member_profile.id [delete:restrict, update:cascade]

// ðŸ”‘
Table member_government_benefit {
  id varchar(49) [primary key, unique, default: `uuid_generate_v4()`]

  created_by_id varchar(49) [ref: - user.id]
  updated_by_id varchar(49) [ref: - user.id]
  deleted_by_id varchar(49) [ref: - user.id]

  branch_id varchar(49)
  organization_id varchar(49)

  member_profile_id varchar(49)
  front_media_id varchar(49)
  back_media_id varchar(49)

  country_code varchar(4)
  description text
  name varchar(254)
  value varchar(254) [unique, not null]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_government_benefit.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_government_benefit.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_government_benefit.front_media_id - media.id [delete:cascade]
Ref: member_government_benefit.back_media_id - media.id [delete:cascade]
Ref: member_government_benefit.member_profile_id > member_profile.id [delete:restrict, update:cascade]

// ðŸ”‘
Table member_income {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  member_profile_id varchar(50)
  media_id varchar(50)
  branch_id varchar(50)
  organization_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  name varchar(255)
  amount decimal
  release_date timestamp

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_income.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_income.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_income.media_id > media.id [delete:cascade, update:cascade]
Ref: member_income.member_profile_id > member_profile.id [delete:restrict, update:cascade]

// ðŸ”‘
Table member_joint_account {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  branch_id varchar(50)
  organization_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  member_profile_id varchar(50)
  picture_media_id varchar(50) [not null]
  signature_media_id varchar(50) [not null]

  description text
  first_name varchar(255) [not null]
  middle_name varchar(255)
  last_name varchar(255) [not null]
  full_name varchar(255) [not null]
  suffix varchar(255)
  birthday timestamp [not null]
  family_relationship family_relationship [not null]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id ) [name: 'organization_branch']
  }

}

Ref: member_joint_account.organization_id > organization.id [delete:cascade, update:cascade]
Ref: member_joint_account.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_joint_account.picture_media_id - media.id [delete:cascade, update:cascade]
Ref: member_joint_account.signature_media_id - media.id [delete:cascade, update:cascade]
Ref: member_joint_account.member_profile_id > member_profile.id [delete:restrict, update:cascade]


// ðŸ”‘
Table member_relative_account {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]
  member_profile_id varchar(50)
  relative_member_profile_id varchar(50)
  branch_id varchar(50)
  organization_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  family_relationship family_relationship [not null]
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_relative_account.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_relative_account.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_relative_account.member_profile_id > member_profile.id [delete:restrict, update:cascade]
Ref: member_relative_account.relative_member_profile_id - member_profile.id [delete:restrict, update:cascade]

// ðŸ”‘
Table member_bank_card {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  bank_id varchar(50)
  member_profile_id varchar(50)

  account_number varchar(50) [not null]
  card_name varchar(50) [not null]
  expiration_date timestamp [not null]

  is_default boolean [default: false]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_bank_card.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_bank_card.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_bank_card.member_profile_id > member_profile.id
Ref: member_bank_card.bank_id - bank.id


// ðŸ”‘
Table member_damayan_extension_entry {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  member_profile_id varchar(50)

  name varchar(255)
  description text

  birthdate timestamp

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_damayan_extension_entry.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_damayan_extension_entry.member_profile_id - member_profile.id [delete:restrict, update:cascade]
Ref: member_damayan_extension_entry.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table member_other_information_entry {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  name varchar(255) [not null]
  description text
  entry_date timestamp

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_other_information_entry.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_other_information_entry.branch_id > branch.id [delete:cascade, update:cascade]



// ðŸ”‘
Table collectors_member_account_entry {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  collector_user_id varchar(50)
  member_profile_id varchar(50)
  account_id varchar(50)
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: collectors_member_account_entry.organization_id > organization.id [delete: cascade, update: cascade]
Ref: collectors_member_account_entry.branch_id > branch.id [delete:cascade, update:cascade]
Ref: collectors_member_account_entry.account_id > account.id [delete:restrict, update:cascade]
Ref: collectors_member_account_entry.collector_user_id > user.id [delete:restrict, update:cascade]
Ref: collectors_member_account_entry.member_profile_id > member_profile.id [delete:restrict, update:cascade]


// ðŸ”‘
Table member_mutual_fund_history {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  member_profile_id varchar(50)
  branch_id varchar(50)
  organization_id varchar(50)

  title varchar(255)
  amount decimal
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_mutual_fund_history.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_mutual_fund_history.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_mutual_fund_history.member_profile_id > member_profile.id [delete:restrict, update:cascade]


//----------- MEMBER HISTORIES START -----------//

// ðŸ”‘
Table member_center_history {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]
  branch_id varchar(50)
  organization_id varchar(50)
  member_center_id varchar(50)
  member_profile_id varchar(50)
  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization-branch']
  }
}

Ref: member_center_history.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_center_history.organization_id > organization.id [delete:cascade, update:cascade]

Ref: member_center_history.member_center_id > member_center.id [delete:restrict, update:cascade]
Ref: member_center_history.member_profile_id > member_profile.id [delete:restrict, update:cascade]


// ðŸ”‘
Table member_gender_history {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  member_profile_id varchar(50)
  member_gender_id varchar(50)
  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  branch_id varchar(50)
  organization_id varchar(50)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_gender_history.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_gender_history.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_gender_history.member_gender_id > member_gender.id [delete:restrict, update:cascade]
Ref: member_gender_history.member_profile_id > member_profile.id [delete:restrict, update:cascade]

// ðŸ”‘
Table member_group_history {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  member_profile_id varchar(50)
  member_group_id varchar(50)
  branch_id varchar(50)
  organization_id varchar(50)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_group_history.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_group_history.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_group_history.member_group_id > member_group.id [delete:restrict,update:cascade]
Ref: member_group_history.member_profile_id > member_profile.id [delete:restrict, update:cascade]


// ðŸ”‘
Table member_occupation_history {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]
  branch_id varchar(50)
  organization_id varchar(50)

  member_profile_id varchar(50)
  member_occupation_id varchar(50)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_occupation_history.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_occupation_history.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_occupation_history.member_occupation_id > member_occupation.id [delete:restrict, update:cascade]
Ref: member_occupation_history.member_profile_id > member_profile.id [delete:restrict, update:cascade]

// ðŸ”‘
Table member_type_history {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]
  member_type_id varchar(50)
  member_profile_id varchar(50)
  branch_id varchar(50)
  organization_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_type_history.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_type_history.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_type_history.member_type_id - member_type.id [delete:restrict, update:cascade]
Ref: member_type_history.member_profile_id > member_profile.id [delete:restrict, update:cascade]

//----------- MEMBER HISTORIES END -----------//

//----------- FOOTSTEP FEATURE

// ðŸ”‘
Table footstep {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  branch_id varchar(50)
  organization_id varchar(50)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  user_type user_type [not null]
  user_id varchar(50) [not null] // who did this action

  module varchar(255) [not null] // where this event take place/source
  description text
  activity varchar(255) [not null] // wtf user did
  latitude decimal(10,7)
  longitude decimal(10,7)
  ip_address varchar(45)
  user_agent varchar(1000)
  referer varchar(1000)
  location varchar(255)
  accept_language varchar(255)

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: footstep.branch_id > branch.id [delete:cascade, update:cascade]
Ref: footstep.organization_id > organization.id [delete:cascade, update:cascade]

Ref: footstep.user_id > user.id [delete:restrict, update:cascade]

//----------- EMPLOYEE FEATURE ------------//

// ðŸ”‘
Table timesheet {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  user_id varchar(50)

  media_in_id varchar(50)
  media_out_id varchar(50)

  time_in timestamp [not null, default: `now()`]
  time_out timestamp

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: timesheet.organization_id > organization.id [delete: cascade, update: cascade]
Ref: timesheet.branch_id > branch.id [delete:cascade, update:cascade]

Ref: timesheet.user_id > user.id [delete:restrict]
Ref: timesheet.media_in_id - media.id [delete:restrict]
Ref: timesheet.media_out_id - media.id [delete:restrict]

//----------- EMPLOYEE FEATURE END ------------//



//----------- ACCOUNTING ------------//

enum accounting_principle {
  positive
  negative
}


// ----- pang report START ----- //

// ðŸ”‘
Table financial_statement_definition {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  financial_statement_definition_id varchar(50)

  name varchar(255) [not null, unique]
  description text
  index integer [default: 0]

  name_in_total varchar(255)
  is_posting boolean [default: false]
  financial_statement_type financial_statement_type

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: financial_statement_definition.organization_id > organization.id [delete: cascade, update: cascade]
Ref: financial_statement_definition.branch_id > branch.id [delete:cascade, update:cascade]
Ref: financial_statement_definition.financial_statement_definition_id < financial_statement_definition.id

// ðŸ”‘
Table general_ledger_accounts_grouping {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  debit accounting_principle [not null]
  credit accounting_principle [not null]
  name varchar(50) [not null]
  description text [not null]

  from_code decimal [default: 0]
  to_code decimal [default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: general_ledger_accounts_grouping.organization_id > organization.id [delete:cascade, update:cascade]
Ref: general_ledger_accounts_grouping.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table financial_statement_accounts_grouping {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]
  icon_media_id varchar(50)

  name varchar(50) [not null]
  description text [not null]

  debit accounting_principle [not null]
  credit accounting_principle [not null]

  code decimal [not null]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: financial_statement_accounts_grouping.organization_id > organization.id [delete:cascade, update:cascade]
Ref: financial_statement_accounts_grouping.branch_id > branch.id [delete:cascade, update:cascade]
Ref: financial_statement_accounts_grouping.icon_media_id > media.id [delete:restrict, update:cascade]

// Financial Statement Definition Types
enum financial_statement_definition_types {
  standard
  group
  "group title"
  "group total"
  "sub group title"
  "sub group total"
  "header total"
}

enum justify {
  left
  right
  center
}

// ðŸ”‘
Table financial_statement_accounts_definition {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  title varchar(255)
  types financial_statement_definition_types [not null, default: "standard"]
  title_margin integer [default: 0]
  exclude boolean [default: false]
  index integer [increment]

  indent integer [default: 0]
  justify justify [default: "left"]

  from_code decimal [default: 0]
  to_code decimal [default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: financial_statement_accounts_definition.branch_id > branch.id [delete:cascade, update:cascade]

enum general_ledger_type {
  "Assets"
  "Liabilities, Equity & Reserves"
  "Income"
  "Expenses"
}

// NOTE: Pang report, ex: sub sub title group title
// ðŸ”‘
Table general_ledger_definition {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  general_ledger_definition_entries_id varchar(50)

  name varchar(255) [not null, unique]
  description text
  index integer [default: 0]

  name_in_total varchar(255)
  is_posting boolean [default: false]
  general_ledger_type general_ledger_type [not null]

  beginning_balance_of_the_year_credit integer [default: 0]
  beginning_balance_of_the_year_debit integer [default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: general_ledger_definition.organization_id > organization.id [delete: cascade, update: cascade]
Ref: general_ledger_definition.branch_id > branch.id [delete:cascade, update:cascade]
Ref: general_ledger_definition.general_ledger_definition_entries_id < general_ledger_definition.id

// ðŸ”‘
Table general_account_grouping_net_surplus_positive {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  account_id varchar(50)

  name varchar(255)
  description text
  percentage_1 decimal [default:0]
  percentage_2 decimal [default:0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: general_account_grouping_net_surplus_positive.organization_id > organization.id [delete: cascade, update: cascade]
Ref: general_account_grouping_net_surplus_positive.account_id > account.id [delete:cascade, update:cascade]
Ref: general_account_grouping_net_surplus_positive.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table general_account_grouping_net_surplus_negative {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  account_id varchar(50)

  name varchar(255)
  description text
  percentage_1 decimal [default:0]
  percentage_2 decimal [default:0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: general_account_grouping_net_surplus_negative.organization_id > organization.id [delete: cascade, update: cascade]
Ref: general_account_grouping_net_surplus_negative.account_id > account.id [delete:cascade, update:cascade]
Ref: general_account_grouping_net_surplus_negative.branch_id > branch.id [delete:cascade, update:cascade]

enum general_ledger_transaction_type {
  "Daily Collection Book"
  "Cash / Check Disbursement Book"
  "General Journal"
}

// ----- pang report END ----- //

// ---- MAINTENANCE TABLE FOR ACCOUNTING ---- //

// ðŸ”‘
Table account_classification {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50) [ref: - user.id]

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  name varchar(255)
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name:'organization_branch']
  }

}

Ref: account_classification.organization_id > organization.id [delete: cascade, update: cascade]
Ref: account_classification.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table account_category {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50) [ref: - user.id]

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  name varchar(255)
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: account_category.organization_id > organization.id [delete: cascade, update: cascade]
Ref: account_category.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table bank {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  media_id varchar(50) [ref: - media.id]

  name varchar(255) [not null]
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: bank.organization_id > organization.id [delete: cascade, update: cascade]
Ref: bank.branch_id > branch.id [delete:cascade, update:cascade]



enum types_of_payment_type {
  cash
  check
  "online"
}

// ðŸ”‘
Table payment_type {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  name varchar(255) [not null]
  description text
  number_of_days integer

  type types_of_payment_type

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: payment_type.organization_id > organization.id [delete: cascade, update: cascade]
Ref: payment_type.branch_id > branch.id [delete:cascade, update:cascade]


// ðŸ”‘
Table bill_and_coins {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  media_id varchar(50)

  name varchar(255)
  value decimal [not null]
  country_code varchar(5) [not null]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: bill_and_coins.organization_id > organization.id [delete: cascade, update: cascade]
Ref: bill_and_coins.media_id - media.id [delete:cascade, update:cascade]
Ref: bill_and_coins.branch_id > branch.id [delete:restrict, update:cascade]

// ---- MAINTENANCE TABLE ACCOUNTING END ---- //
enum account_type {
  Deposit
  Loan
  "A/R-Ledger"
  "A/R-Aging"
  Fines
  Interest
  "SVF-Ledger"
  "W-Off"
  "A/P-Ledger"
  Other
}

enum financial_statement_type {
  "Assets"
  "Liabilities"
  "Equity"
  "Revenue"
  "Expenses"
}

enum lumpsum_computation_type {
  "None"
  "Compute Fines Maturity"
  "Compute Interest Maturity / Terms"
  "Compute Advance Interest"
}

enum interest_fines_computation_diminishing {
  "None"
  "By Amortization"
  "By Amortization Daly on Interest Principal + Interest = Fines(Arr)"
}

enum interest_fines_computation_diminishing_straight_diminishing_yearly {
  "None"
  "By Daily on Interest based on loan balance by year Principal + Interest Amortization = Fines Fines Grace Period Month end Amortization"
}

enum earned_unearned_interest {
  "None"
  "By Formula"
  "By Formula + Actual Pay"
  "By Advance Interest + Actual Pay"
}

enum loan_saving_type {
  "Separate"
  "Single Ledger"
  "Single Ledger if Not Zero"
  "Single Ledger Semi (15/30)"
  "Single Ledger Semi Within Maturity"
}

enum interest_deduction {
  "above"
  "Below"
}

enum other_deduction_entry {
  "None"
  "Health Care"
}

enum interest_saving_type_diminishing_straight {
  "Spread"
  "1st Payment"
}

enum other_information_of_an_account {
  "None"
  "Jewely"
  "Grocery"
  "Track Loan Deduction"
  "Restructured"
  "Cash in Bank / Cash in Check Account"
  "Cash on Hand"
}

// ðŸ”‘
Table account {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  general_ledger_definition_id varchar(50) // other
  financial_statement_definition_id varchar(50) // other
  account_classification_id varchar(50) [ref: - account_classification.id]
  account_category_id varchar(50) [ref: - account_category.id]
  member_type_id varchar(50)

  name varchar(255) [not null] // general, other
  description text [not null] // general, other

  minAmount decimal [default: 0] // For deposit
  maxAmount decimal [default: 50000] // For deposit
  index integer [default: 0]
  type account_type [not null] // general

  // Settings only one of them must be true
  is_internal boolean [default: false]
  cash_on_hand boolean [default: false]
  paid_up_share_capital boolean [default:false]

  // Pang Loan
  computation_type computation_type // For loan

  fines_amort decimal // For loan
  fines_maturity decimal // For loan

  interest_standard decimal // For loan
  interest_secured decimal // For loan

  computation_sheet_id varchar(50) // for loan, Scheme No in old system

  coh_cib_fines_grace_period_entry_cash_hand decimal [default: 0]
  coh_cib_fines_grace_period_entry_cash_in_bank decimal [default: 0]

  coh_cib_fines_grace_period_entry_daily_amortization decimal [default: 0]
  coh_cib_fines_grace_period_entry_daily_maturity decimal [default: 0]

  coh_cib_fines_grace_period_entry_weekly_amortization decimal [default: 0]
  coh_cib_fines_grace_period_entry_weekly_maturity decimal [default: 0]

  coh_cib_fines_grace_period_entry_monthly_amortization decimal [default: 0]
  coh_cib_fines_grace_period_entry_monthly_maturity decimal [default: 0]

  coh_cib_fines_grace_period_entry_semi_monthly_amortization decimal [default: 0]
  coh_cib_fines_grace_period_entry_semi_monthly_maturity decimal [default: 0]

  coh_cib_fines_grace_period_entry_quarterly_amortization decimal [default: 0]
  coh_cib_fines_grace_period_entry_quarterly_maturity decimal [default: 0]

  coh_cib_fines_grace_period_entry_semi_anual_amortization decimal [default: 0]
  coh_cib_fines_grace_period_entry_semi_anual_maturity decimal [default: 0]

  coh_cib_fines_grace_period_entry_lumpsum_amortization decimal [default: 0]
  coh_cib_fines_grace_period_entry_lumpsum_maturity decimal [default: 0]

  financial_statement_type financial_statement_type
  general_ledger_type general_ledger_type // other

  // interest_secured_account_id varchar(50)
  alternative_code varchar(50) // general, other, loan

  fines_grace_period_amortization integer // number of days schedule of payment, ex: april 10, if di nakabhayad meron pang 2 days // For loan
  additional_grace_period integer //number of days
  // cut_off_days // wla muna
  // cut_off_months

  number_grace_period_daily boolean [default: false]

  fines_grace_period_maturity integer // number of days
  yearly_subscription_fee integer
  loan_cut_off_days integer

  // MGA RADIO BUTTON ENUMS

  lumpsum_computation_type lumpsum_computation_type [default: "None"] // Tska na to
  interest_fines_computation_diminishing interest_fines_computation_diminishing [default: "None"]
  interest_fines_computation_diminishing_straight_diminishing_yearly interest_fines_computation_diminishing_straight_diminishing_yearly [default: "None"]
  earned_unearned_interest earned_unearned_interest [default: "None"] // loan
  loan_saving_type loan_saving_type [default: "Separate"] // loan
  interest_deduction interest_deduction [default:"Above"] // loan

  other_deduction_entry other_deduction_entry [default: "None"]
  interest_saving_type_diminishing_straight interest_saving_type_diminishing_straight [default: "Spread"]
  other_information_of_an_account other_information_of_an_account [default: "None"]

  header_row integer // Show accross all type/General
  center_row integer // Show accross all type/General
  total_row integer // Show accross all type/General

  general_ledger_grouping_exclude_account boolean [default: false]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

// // Ref: account.interest_secured_account_id - account.id [delete:cascade, update:cascade]
Ref: account.organization_id > organization.id [delete: cascade, update: cascade]
Ref: account.branch_id > branch.id [delete:cascade, update:cascade]
// Ref: account.general_ledger_definition_id > general_ledger_definition.id
// Ref: account.alternative_code - account.id [delete:restrict, update:cascade]
// Ref: account.general_ledger_definition_id > financial_statement_definition.id
Ref: account.member_type_id - member_type.id [delete:restrict, update:restrict]
Ref: account.computation_sheet_id - computation_sheet.id [delete:restrict, update:restrict]


// ðŸ”‘
Table account_tag {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  account_id varchar(50)

  name varchar(50)
  description text
  category tag_category
  color varchar(20)
  icon varchar(20)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: account_tag.organization_id > organization.id [delete: cascade, update: cascade]
Ref: account_tag.branch_id > branch.id [delete:cascade, update:cascade]
Ref: account_tag.account_id > account.id [delete:cascade, update:cascade]

//----------- ACCOUNTIN END ------------//


// ----- LEDGERS START ----- //


enum general_ledger_source {
  withdraw
  deposit
  journal
  payment
  adjustment
  "journal voucher"
  "check voucher"
}

// ðŸ”‘
Table general_accounting_ledger {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  account_id varchar(50)
  transaction_id varchar(50)
  transaction_batch_id varchar(50)

  employee_user_id varchar(50) // sino employee
  member_profile_id varchar(50)
  member_joint_account_id varchar(50) // ka may ari nang account yung gumamit/nag transact

  transaction_reference_number varchar(50)
  reference_number varchar(50)
  payment_type_id varchar(50)

  source general_ledger_source
  journal_voucher_id varchar(50)
  adjustment_entry_id varchar(50)
  type_of_payment_type types_of_payment_type

  credit decimal
  debit decimal
  balance decimal

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: general_accounting_ledger.organization_id > organization.id [delete: cascade, update: cascade]
Ref: general_accounting_ledger.branch_id > branch.id [delete:cascade, update:cascade]
Ref: general_accounting_ledger.transaction_id > transaction.id [delete:restrict, update:cascade]
Ref: general_accounting_ledger.transaction_batch_id > transaction_batch.id [delete:restrict, update:cascade]
Ref: general_accounting_ledger.payment_type_id > payment_type.id [delete:restrict, update:cascade]
Ref: general_accounting_ledger.employee_user_id > user.id [delete:restrict, update:cascade]
Ref: general_accounting_ledger.adjustment_entry_id > adjustment_entry.id [delete:restrict, update:cascade]
Ref: general_accounting_ledger.member_joint_account_id > member_joint_account.id [delete:restrict, update:cascade]
Ref: general_accounting_ledger.account_id - account.id [delete:restrict, update:cascade]
Ref: general_accounting_ledger.member_profile_id > member_profile.id [delete:restrict, update:cascade]

// ðŸ”‘
Table general_accounting_ledger_tag {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  general_accounting_ledger_id varchar(50)

  name varchar(50)
  description text
  category tag_category
  color varchar(20)
  icon varchar(20)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: general_accounting_ledger_tag.organization_id > organization.id [delete: cascade, update: cascade]
Ref: general_accounting_ledger_tag.branch_id > branch.id [delete:cascade, update:cascade]
Ref: general_accounting_ledger_tag.general_accounting_ledger_id > general_accounting_ledger.id [delete:cascade, update:cascade]


// ðŸ”‘
Table general_ledger_transaction {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  journal_voucher_number varchar(50)
  entry_date date
  name varchar(255)
  description text

  total_debit decimal
  total_credit decimal

  is_posted boolean [default:false]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: general_ledger_transaction.organization_id > organization.id [delete: cascade, update: cascade]
Ref: general_ledger_transaction.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table general_ledger_transaction_entry {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  account_id varchar(50)
  general_ledger_transaction_entry_id varchar(50)

  debit decimal
  credit decimal

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: general_ledger_transaction_entry.organization_id > organization.id [delete: cascade, update: cascade]
Ref: general_ledger_transaction_entry.branch_id > branch.id [delete:cascade, update:cascade]
Ref: general_ledger_transaction_entry.general_ledger_transaction_entry_id > general_ledger_transaction_entry.id [delete:cascade, update:cascade]
Ref: general_ledger_transaction_entry.account_id > account.id [delete:cascade, update:cascade]

// ðŸ”‘
Table member_accounting_ledger {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  member_profile_id varchar(50)
  account_id varchar(50)

  count integer
  balance decimal
  interest decimal
  fines decimal
  due decimal
  carried_forward_due decimal //are u sure?
  stored_value_facility decimal
  principal_due decimal
  last_pay timestamp

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_accounting_ledger.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_accounting_ledger.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_accounting_ledger.account_id > account.id [delete:cascade, update:cascade]
Ref: member_accounting_ledger.member_profile_id > member_profile.id [delete:cascade, update:cascade]

// ----- LEDGERS END ---- //

// ----- TRANSACTION START ----- //

enum transaction_batch_balance_status {
  balanced // tot. suposed remitance = tot. actual remitance
  "balance overage" // tot. actual > tot. suposed
  "balance shortage" // tot. suposed > tot. actual
}

// ðŸ”‘
Table transaction_batch {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  employee_user_id varchar(50)

  batch_name varchar(50)
  total_cash_collection decimal // collection from or in old coop sys
  total_deposit_entry decimal

  beginning_balance decimal
  deposit_in_bank decimal // too lazy to cash count, just know the total
  cash_count_total decimal // cash count total
  grand_total decimal // cash_count + deposit in bank

  // LESS
  petty_cash decimal // disbursement, commercial check, transfer to rf
  loan_releases decimal
  time_deposit_withdrawal decimal // WTF unknown
  savings_withdrawal decimal
  // end LESS

  total_cash_handled decimal // beg_bal + deposit + collection (REAL CASH ONLY)
  total_supposed_remitance decimal // total_cash_handled + deposit - withdrawals
  total_cash_on_hand decimal
  total_check_remittance decimal // input sa check remitance module
  total_online_remittance decimal // input sa online
  total_deposit_in_bank decimal
  total_actual_remittance decimal // total_check_remitance + total_online_remittance + total_cash_on_hand + total_deposit_in_bank

  total_actual_supposed_comparison decimal // abs(total supposed remittance) + abs(total actual remittance)

  description text

  can_view boolean [default: false] // if employee is allowed to view-his/her transaction batch via blotter
  is_closed boolean [default: false] // if teller terminate the blotter

  // SIGNATURES

  approved_by_signature_media_id varchar(50) [ref: - media.id]
  approved_by_name varchar(255)
  approved_by_position varchar(255)

  prepared_by_signature_media_id varchar(50) [ref: - media.id]
  prepared_by_name varchar(255)
  prepared_by_position varchar(255)

  certified_by_signature_media_id varchar(50) [ref: - media.id]
  certified_by_name varchar(255)
  certified_by_position varchar(255)

  verified_by_signature_media_id varchar(50) [ref: - media.id]
  verified_by_name varchar(255)
  verified_by_position varchar(255)

  check_by_signature_media_id varchar(50) [ref: - media.id]
  check_by_name varchar(255)
  check_by_position varchar(255)

  acknowledge_by_signature_media_id varchar(50) [ref: - media.id]
  acknowledge_by_name varchar(255)
  acknowledge_by_position varchar(255)

  noted_by_signature_media_id varchar(50) [ref: - media.id]
  noted_by_name varchar(255)
  noted_by_position varchar(255)

  posted_by_signature_media_id varchar(50) [ref: - media.id]
  posted_by_name varchar(255)
  posted_by_position varchar(255)

  paid_by_signature_media_id varchar(50) [ref: - media.id]
  paid_by_name varchar(255)
  paid_by_position varchar(255)

  ended_at timestamp
  total_batch_time timestamp

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: transaction_batch.organization_id > organization.id [delete: cascade, update: cascade]
Ref: transaction_batch.branch_id > branch.id [delete:cascade, update:cascade]
Ref: transaction_batch.employee_user_id > user.id

// ðŸ”‘
Table check_remittance {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  bank_id varchar(50)
  media_id varchar(50) [ref: - media.id]
  employee_user_id varchar(50)
  transaction_batch_id varchar(50)

  country_code varchar(5)
  reference_number varchar(255)
  account_name varchar(255)
  amount decimal [not null]
  date_entry timestamp
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: check_remittance.organization_id > organization.id [delete: cascade, update: cascade]
Ref: check_remittance.branch_id > branch.id [delete:cascade, update:cascade]
Ref: check_remittance.transaction_batch_id > transaction_batch.id [delete:restrict, update:cascade]
Ref: check_remittance.bank_id > bank.id [delete:restrict , update:cascade]
Ref: check_remittance.employee_user_id > user.id [delete:restrict, update:cascade]

// ðŸ”‘
Table online_remittance {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  bank_id varchar(50)
  media_id varchar(50) [ref: - media.id]
  employee_user_id varchar(50)
  transaction_batch_id varchar(50)

  country_code varchar(5)
  reference_number varchar(255)
  amount decimal [not null]
  account_name varchar(255)
  date_entry timestamp
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: online_remittance.organization_id > organization.id [delete: cascade, update: cascade]
Ref: online_remittance.branch_id > branch.id [delete:cascade, update:cascade]
Ref: online_remittance.transaction_batch_id > transaction_batch.id [delete:restrict, update:cascade]
Ref: online_remittance.bank_id > bank.id [delete:restrict , update:cascade]
Ref: online_remittance.employee_user_id > user.id [delete:restrict, update:cascade]

// ðŸ”‘
Table cash_count {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  employee_user_id varchar(50)
  transaction_batch_id varchar(50)

  country_code varchar(5) [not null]
  bill_amount decimal
  quantity integer
  amount decimal // bill_amount * quantity

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: cash_count.organization_id > organization.id [delete: cascade, update: cascade]
Ref: cash_count.branch_id > branch.id [delete:cascade, update:cascade]
Ref: cash_count.transaction_batch_id > transaction_batch.id [delete:cascade, update:cascade]
Ref: cash_count.employee_user_id > user.id [delete:cascade, update:cascade]

// ðŸ”‘
Table intra_batch_funding {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  transaction_batch_id varchar(50)
  provided_by_user_id varchar(50)
  signature_media_id varchar(50)

  name varchar(50)
  amount decimal
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: intra_batch_funding.organization_id > organization.id [delete: cascade, update: cascade]
Ref: intra_batch_funding.branch_id > branch.id [delete:cascade, update:cascade]
Ref: intra_batch_funding.signature_media_id - media.id [delete:cascade, update:cascade]
Ref: intra_batch_funding.transaction_batch_id > transaction_batch.id [delete:cascade, update:cascade]
Ref: intra_batch_funding.provided_by_user_id > user.id [delete:cascade, update:cascade]

// eto na yung payment
// ðŸ”‘
Table transaction {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  account_id varchar(50)
  signature_media_id varchar(50)
  transaction_batch_id varchar(50)

  employee_user_id varchar(50) // sino employee
  member_profile_id varchar(50)
  member_joint_account_id varchar(50) // ka may ari nang account yung gumamit/nag transact

  loan_balance decimal [default:0]
  loan_due decimal [default:0]
  total_due decimal [default:0]
  fines_due decimal [default:0]
  total_loan decimal [default:0]
  interest_due decimal [default:0]

  transaction_reference_number varchar(50) [unique]
  reference_number varchar(50) // OR ito
  source general_ledger_source

  amount decimal
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: transaction.organization_id > organization.id [delete: cascade, update: cascade]
Ref: transaction.branch_id > branch.id [delete:cascade, update:cascade]
Ref: transaction.signature_media_id - media.id [delete:restrict, update:cascade]
Ref: transaction.transaction_batch_id > transaction_batch.id [delete:restrict, update:cascade]
Ref: transaction.member_joint_account_id > member_joint_account.id [delete:restrict, update:cascade]
Ref: transaction.account_id - account.id [delete:restrict, update:cascade]
Ref: transaction.member_profile_id > member_profile.id [delete:restrict, update:cascade]
Ref: transaction.employee_user_id > user.id [delete:restrict, update:cascade]

// ðŸ”‘
Table transaction_tag {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  transaction_id varchar(50)

  name varchar(50)
  description text
  category tag_category
  color varchar(20)
  icon varchar(20)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: transaction_tag.organization_id > organization.id [delete: cascade, update: cascade]
Ref: transaction_tag.branch_id > branch.id [delete:cascade, update:cascade]
Ref: transaction_tag.transaction_id > transaction.id [delete:cascade, update:cascade]

// ðŸ”‘
Table check_entry [headercolor: #00ff26] {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  account_id varchar(50)
  media_id varchar(50)
  bank_id varchar(50)
  member_profile_id varchar(50)
  member_joint_account_id varchar(50) // ka may ari nang account yung gumamit/nag transact
  employee_user_id varchar(50)

  transaction_id varchar(50)
  transaction_batch_id varchar(50)
  general_accounting_ledger_id varchar(50)
  disbursement_transaction_id varchar(50)

  credit decimal
  debit decimal
  check_number varchar(255) [not null]
  check_date timestamp

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: check_entry.organization_id > organization.id [delete: cascade, update: cascade]
Ref: check_entry.branch_id > branch.id [delete:cascade, update:cascade]
Ref: check_entry.transaction_id > transaction.id [delete:restrict, update: cascade]
Ref: check_entry.disbursement_transaction_id - disbursement_transaction.id [delete:restrict, update:cascade]
Ref: check_entry.employee_user_id > user.id [delete:restrict, update:cascade]
Ref: check_entry.member_profile_id > member_profile.id [delete:restrict, update: cascade]
Ref: check_entry.member_joint_account_id > member_joint_account.id [delete:restrict, update: cascade]
Ref: check_entry.account_id > account.id [delete:restrict, update:cascade]
Ref: check_entry.media_id - media.id [delete:restrict, update:cascade]
Ref: check_entry.transaction_batch_id > transaction_batch.id [delete:restrict, update:cascade]
Ref: check_entry.general_accounting_ledger_id > general_accounting_ledger.id [delete:restrict, update:cascade]
Ref: check_entry.bank_id > bank.id [delete:restrict, update:cascade]

// ðŸ”‘
Table online_entry [headercolor: #00ff26] {
  id varchar(50)

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  bank_id varchar(50)
  account_id varchar(50)
  member_profile_id varchar(50)
  member_joint_account_id varchar(50) // ka may ari nang account yung gumamit/nag transact
  transaction_batch_id varchar(50)
  general_accounting_ledger_id varchar(50)
  transaction_id varchar(50)
  employee_user_id varchar(50)
  disbursement_transaction_id varchar(50)

  reference_number varchar(255) [not null]
  payment_date timestamp
  debit decimal
  credit decimal

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: online_entry.organization_id > organization.id [delete: cascade, update: cascade]
Ref: online_entry.branch_id > branch.id [delete:cascade, update:cascade]
Ref: online_entry.employee_user_id > user.id [delete:restrict, update:cascade]
Ref: online_entry.member_joint_account_id > member_joint_account.id [delete:restrict, update:cascade]
Ref: online_entry.transaction_id > transaction.id [delete:restrict, update: cascade]
Ref: online_entry.bank_id > bank.id [delete:restrict, update:cascade]
Ref: online_entry.transaction_batch_id > transaction_batch.id [delete:restrict, update:cascade]
Ref: online_entry.disbursement_transaction_id - disbursement_transaction.id [delete:restrict, update:cascade]
Ref: online_entry.general_accounting_ledger_id > general_accounting_ledger.id [delete:restrict, update:cascade]
Ref: online_entry.account_id > account.id [delete:restrict, update:cascade]
Ref: online_entry.member_profile_id > member_profile.id [delete:restrict, update: cascade]

// ðŸ”‘
Table cash_entry [headercolor: #00ff26] {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  account_id varchar(50) // nullable if disbursement
  member_profile_id varchar(50) // nullable if disbursement
  member_joint_account_id varchar(50) // ka may ari nang account yung gumamit/nag transact // nullable if disbursement
  transaction_batch_id varchar(50)
  general_accounting_ledger_id varchar(50) // nullable if disbursement
  transaction_id varchar(50)// nullable if disbursement
  employee_user_id varchar(50)
  disbursement_transaction_id varchar(50)

  reference_number varchar(255) [not null]
  debit decimal
  credit decimal

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: cash_entry.organization_id > organization.id [delete: cascade, update: cascade]
Ref: cash_entry.branch_id > branch.id [delete:cascade, update:cascade]
Ref: cash_entry.transaction_id > transaction.id [delete:restrict, update: cascade]
Ref: cash_entry.member_joint_account_id > member_joint_account.id [delete:restrict, update:cascade]
Ref: cash_entry.employee_user_id > user.id [delete:restrict, update:cascade]
Ref: cash_entry.disbursement_transaction_id - disbursement_transaction.id [delete:restrict, update:cascade]
Ref: cash_entry.transaction_batch_id > transaction_batch.id [delete:restrict, update:cascade]
Ref: cash_entry.general_accounting_ledger_id > general_accounting_ledger.id [delete:restrict, update:cascade]
Ref: cash_entry.account_id > account.id [delete:restrict, update:cascade]
Ref: cash_entry.member_profile_id > member_profile.id [delete:restrict, update: cascade]

// ðŸ”‘
Table withdrawal_entry [headercolor: #00ff26] {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  member_profile_id varchar(50)
  transaction_id varchar(50)
  member_joint_account_id varchar(50) // ka may ari nang account yung gumamit/nag transact
  general_accounting_ledger_id varchar(50)
  transaction_batch_id varchar(50)
  signature_media_id varchar(50)
  account_id varchar(50)
  employee_user_id varchar(50)

  reference_number varchar(50)
  debit decimal
  credit decimal

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: withdrawal_entry.organization_id > organization.id [delete: cascade, update: cascade]
Ref: withdrawal_entry.branch_id > branch.id [delete:cascade, update:cascade]
Ref: withdrawal_entry.transaction_id > transaction.id [delete:restrict, update: cascade]
Ref: withdrawal_entry.signature_media_id - media.id [delete:restrict, update: cascade]
Ref: withdrawal_entry.member_joint_account_id > member_joint_account.id [delete:restrict, update: cascade]
Ref: withdrawal_entry.general_accounting_ledger_id > general_accounting_ledger.id [delete:restrict, update: cascade]
Ref: withdrawal_entry.employee_user_id > user.id [delete:restrict, update:cascade]
Ref: withdrawal_entry.member_profile_id > member_profile.id [delete:restrict, update: cascade]
Ref: withdrawal_entry.transaction_batch_id > transaction_batch.id [delete:restrict, update: cascade]
Ref: withdrawal_entry.account_id > account.id [delete:restrict, update:cascade]

// ðŸ”‘
Table deposit_entry [headercolor: #00ff26] {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  member_profile_id varchar(50)
  transaction_id varchar(50)
  member_joint_account_id varchar(50) // ka may ari nang account yung gumamit/nag transact
  general_accounting_ledger_id varchar(50)
  transaction_batch_id varchar(50)
  signature_media_id varchar(50)
  account_id varchar(50)
  employee_user_id varchar(50)

  reference_number varchar(50)
  amount decimal

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: deposit_entry.organization_id > organization.id [delete: cascade, update: cascade]
Ref: deposit_entry.branch_id > branch.id [delete:cascade, update:cascade]
Ref: deposit_entry.transaction_id > transaction.id [delete:restrict, update: cascade]
Ref: deposit_entry.signature_media_id - media.id [delete:restrict, update: cascade]
Ref: deposit_entry.employee_user_id > user.id [delete:restrict, update:cascade]
Ref: deposit_entry.member_joint_account_id > member_joint_account.id [delete:restrict, update: cascade]
Ref: deposit_entry.general_accounting_ledger_id > general_accounting_ledger.id [delete:restrict, update: cascade]
Ref: deposit_entry.member_profile_id > member_profile.id [delete:restrict, update: cascade]
Ref: deposit_entry.transaction_batch_id > transaction_batch.id [delete:restrict, update: cascade]
Ref: deposit_entry.account_id > account.id [delete:restrict, update:cascade]


// ITO AY PAYMENT DATI SA OLD COOP SYS
//

// ðŸ”‘
Table transaction_entry {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  member_profile_id varchar(50)
  employee_user_id varchar(50)
  transaction_id varchar(50)
  member_joint_account_id varchar(50) // ka may ari nang account yung gumamit/nag transact
  general_accounting_ledger_id varchar(50)
  transaction_batch_id varchar(50)
  signature_media_id varchar(50)
  account_id varchar(50)

  reference_number varchar(50)
  debit decimal
  credit decimal

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: transaction_entry.organization_id > organization.id [delete: cascade, update: cascade]
Ref: transaction_entry.branch_id > branch.id [delete:cascade, update:cascade]
Ref: transaction_entry.employee_user_id > user.id [delete:restrict, update:cascade]
Ref: transaction_entry.transaction_id > transaction.id [delete:restrict, update: cascade]
Ref: transaction_entry.signature_media_id - media.id [delete:restrict, update: cascade]
Ref: transaction_entry.member_joint_account_id > member_joint_account.id [delete:restrict, update: cascade]
Ref: transaction_entry.general_accounting_ledger_id > general_accounting_ledger.id [delete:restrict, update: cascade]
Ref: transaction_entry.member_profile_id > member_profile.id [delete:restrict, update: cascade]
Ref: transaction_entry.transaction_batch_id > transaction_batch.id [delete:restrict, update: cascade]
Ref: transaction_entry.account_id > account.id [delete:restrict, update:cascade]

// ðŸ”‘
Table disbursement_transaction [headercolor: #00ff26] {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  disbursement_id varchar(50)
  transaction_batch_id varchar(50)

  employee_user_id varchar(50) // sino employee

  transaction_reference_number varchar(50)
  reference_number varchar(50)

  amount decimal

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: disbursement_transaction.organization_id > organization.id [delete: cascade, update: cascade]
Ref: disbursement_transaction.branch_id > branch.id [delete:cascade, update:cascade]
Ref: disbursement_transaction.transaction_batch_id > transaction_batch.id [delete:restrict, update:cascade]
Ref: disbursement_transaction.disbursement_id > disbursement.id [delete:restrict, update:cascade]
Ref: disbursement_transaction.employee_user_id > user.id [delete:restrict, update:cascade]

// NOTE: Eto yung type kapag si teller nag didisburse entry
// ðŸ”‘
Table disbursement [headercolor: #00ff26] {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  name varchar(50)
  icon varchar(50)
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: disbursement.organization_id > organization.id [delete: cascade, update: cascade]
Ref: disbursement.branch_id > branch.id [delete:cascade, update:cascade]


// ----- TRANSACTION END ----- //


// ------- LOAN START ------- //

// Maintenance

enum computation_type {
  "Straight"
  "Deminishing"
  "Diminishing Add-On"
  "Diminishing Yearly"
  "Diminishing Straight"
  "Diminishing Quarterly"
}

// ðŸ”‘
Table computation_sheet {
  id varchar(49) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(49)
  branch_id varchar(49)

  created_by_id varchar(49) [ref: - user.id]
  updated_by_id varchar(49) [ref: - user.id]
  deleted_by_id varchar(49) [ref: - user.id]

  name varchar(254)
  description text

  deliquent_account boolean [default: false] // lahat nang loan na past due
  fines_account boolean [default: false] //
  interest_account_id boolean [default: false]
  comaker_account decimal [default: -1]
  exist_account boolean [default: false]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: computation_sheet.organization_id > organization.id [delete: cascade, update: cascade]
Ref: computation_sheet.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table fines_maturity {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]
  account_id varchar(50)

  from integer [not null, default: 0]
  to integer [not null, default: 0]
  rate decimal [not null, default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization-branch']
  }

}

Ref: fines_maturity.organization_id > organization.id [delete: cascade, update: cascade]
Ref: fines_maturity.account_id > account.id [delete:cascade, update:cascade]
Ref: fines_maturity.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table interest_maturity {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  account_id varchar(50)

  from integer [not null, default: 0]
  to integer [not null, default: 0]
  rate decimal [not null, default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: interest_maturity.organization_id > organization.id [delete: cascade, update: cascade]
Ref: interest_maturity.branch_id > branch.id [delete:cascade, update:cascade]
Ref: interest_maturity.account_id > account.id [delete:cascade, update:cascade]

// ðŸ”‘
Table include_negative_account {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  computation_sheet_id varchar(50)
  account_id varchar(50)

  description text // just short description

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: include_negative_account.organization_id > organization.id [delete: cascade, update: cascade]
Ref: include_negative_account.branch_id > branch.id [delete:cascade, update:cascade]
Ref: include_negative_account.account_id - account.id [delete:restrict, update:cascade]
Ref: include_negative_account.computation_sheet_id > computation_sheet.id [delete:restrict, update:cascade]

// ðŸ”‘
Table automatic_loan_deduction {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  account_id varchar(50)
  computation_sheet_id varchar(50)

  //CHARGES
  charges_percentage_1 decimal
  charges_percentage_2 decimal
  charges_amount decimal
  charges_divisor decimal

  min_amount decimal
  max_amount decimal

  anum integer // months , if naka 1 compute interest based number of months
  // number_of_months integer
  link_account_id varchar(50)
  add_on boolean [default: false] // add onn para buo loan
  ao_rest boolean [default: false] //
  exclude_renewal boolean [default: false]
  ct integer // TODO: unknown, wtf is this?

  name varchar(255)
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: automatic_loan_deduction.organization_id > organization.id [delete: cascade, update: cascade]
Ref: automatic_loan_deduction.branch_id > branch.id [delete:cascade, update:cascade]
Ref: automatic_loan_deduction.computation_sheet_id > computation_sheet.id [delete: restrict, update: cascade]
Ref: automatic_loan_deduction.account_id - account.id [delete: restrict, update: cascade]
Ref: automatic_loan_deduction.link_account_id - account.id [delete:restrict, update:cascade]

// ðŸ”‘
Table browse_exclude_include_accounts {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)
  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  computation_sheet_id varchar(50)
  fines_account_id varchar(50)
  comaker_account_id varchar(50)
  interest_account_id varchar(50)
  deliquent_account_id varchar(50)
  include_existing_loan_account_id varchar(50)


  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: browse_exclude_include_accounts.organization_id > organization.id [delete: cascade, update: cascade]
Ref: browse_exclude_include_accounts.branch_id > branch.id [delete:cascade, update:cascade]
Ref: browse_exclude_include_accounts.computation_sheet_id > computation_sheet.id [delete:restrict, update:cascade]
Ref: browse_exclude_include_accounts.deliquent_account_id - account.id [delete:restrict, update:cascade]
Ref: browse_exclude_include_accounts.fines_account_id - account.id [delete:restrict, update:cascade]
Ref: browse_exclude_include_accounts.interest_account_id - account.id [delete:restrict, update:cascade]
Ref: browse_exclude_include_accounts.comaker_account_id - account.id [delete:restrict, update:cascade]
Ref: browse_exclude_include_accounts.include_existing_loan_account_id - account.id [delete:restrict, update:cascade]

// ðŸ”‘
Table member_classification_interest_rate {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  name varchar(255)
  description text

  interest_rate_scheme_id varchar(50)
  member_classification_id varchar(50)
  interest_rate_by_terms_header_id varchar(50)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_classification_interest_rate.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_classification_interest_rate.branch_id > branch.id [delete:cascade, update:cascade]
// Ref: member_classification_interest_rate.interest_rate_scheme_id > interest_rate_scheme.id [delete: restrict, update: cascade]
Ref: member_classification_interest_rate.member_classification_id - member_classification.id [delete: restrict, update: cascade]
// Ref: member_classification_interest_rate.interest_rate_by_terms_header_id - interest_rate_by_terms_header.id [delete: restrict, update: cascade]


// ðŸ”‘
Table loan_guaranteed_fund_per_month {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  month integer [default: 0]
  loan_guaranteed_fund integer [default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: loan_guaranteed_fund_per_month.organization_id > organization.id [delete: cascade, update: cascade]
Ref: loan_guaranteed_fund_per_month.branch_id > branch.id [delete:cascade, update:cascade]

// Maintenance End

// ðŸ”‘
Table loan_status {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  name varchar(255)
  icon varchar(255) // ICON FROM REACT ICONS
  color varchar(255) // color fill of the icon
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: loan_status.organization_id > organization.id [delete: cascade, update: cascade]
Ref: loan_status.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table loan_guaranteed_fund {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  scheme_number integer [not null, unique]
  increasing_rate decimal [not null]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: loan_guaranteed_fund.organization_id > organization.id [delete: cascade, update: cascade]
Ref: loan_guaranteed_fund.branch_id > branch.id [delete:cascade, update:cascade]


enum loan_mode_of_payment {
  daily
  weekly
  "semi-monthly"
  monthly
  quarterly
  "semi-annual"
  lumpsum
}

enum weekdays {
  monday
  tuesday
  wednesday
  thursday
  friday
  saturday
  sunday
}

enum loan_collector_place {
  office
  field
}

enum loan_comaker_type {
  member
  deposit
  others
}

enum loan_type {
  standard
  restructured
  "standard previous"
  renewal
  "renewal without deduction"
}

enum loan_amortization_type {
  suggested
  none
}

// this is where all loan application is stored
// ðŸ”‘
Table loan_transaction {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  transaction_batch_id varchar(50)
  official_receipt_number varchar(255)
  loan_purpose_id varchar(50)

  loan_status_id varchar(50)

  // mode of payments
  mode_of_payment loan_mode_of_payment
  mode_of_payment_weekly weekdays // if mode of payment is set to weekly
  mode_of_payment_semi_monthly_pay_1 integer // days, if mode of payment is set to semi-monthly
  mode_of_payment_semi_monthly_pay_2 integer // days, if mode of payment is set to semi-monthly

  // Co-maker
  comaker_type loan_comaker_type
  comaker_deposit_member_accounting_ledger_id varchar(50)
  comaker_collateral_id varchar(50)
  comaker_collateral_description text

  collector_place loan_collector_place [default: "office"]

  loan_type loan_type [default: "standard"]
  // kapag restructured, meron kang existing voucher
  previous_loan_id varchar(50) // standard-cannot type, restructured-can type, only loan that are released
  terms integer [not null] // standard-cantype, restructured-cantype

  // AMORTIZATION
  amortization_amount decimal
  is_add_on boolean

  // APPLIED
  applied_1 decimal [not null] // naggapply sa account
  applied_2 decimal // nag aapply sa cashonhand

  account_id varchar(50)
  member_profile_id varchar(50)
  member_joint_account_id varchar(50) // ka may ari nang account yung gumamit/nag transact
  signature_media_id varchar(50) // Signature kung sino man nag apply nang loan

  // Clearance Analysis
  mount_to_be_closed decimal
  damayan_fund decimal
  share_capital decimal
  length_of_service varchar

  exclude_sunday boolean [default:false]
  exclude_holiday boolean [default:false]
  exclude_saturday boolean [default:false]

  // Remarks / Terms & Condition
  remarks_other_terms text
  remarks_payroll_deduction boolean [default: false]
  record_of_loan_payments_or_loan_status varchar(255)

  collateral_offered text

  // LOAN APPRAISED VALUE - this is Other/jewelry tab in old coop
  appraised_value decimal
  appraised_value_description text

  printed_date timestamp
  approved_date timestamp
  released_date timestamp // everytime na marerelease magkakaron sa transaction batch CDV History at CASH Voucher sa LESS

  // SIGNATURES
  approved_by_signature_media_id varchar(50) [ref: - media.id]
  approved_by_name varchar(255)
  approved_by_position varchar(255)

  prepared_by_signature_media_id varchar(50) [ref: - media.id]
  prepared_by_name varchar(255)
  prepared_by_position varchar(255)

  certified_by_signature_media_id varchar(50) [ref: - media.id]
  certified_by_name varchar(255)
  certified_by_position varchar(255)

  verified_by_signature_media_id varchar(50) [ref: - media.id]
  verified_by_name varchar(255)
  verified_by_position varchar(255)

  check_by_signature_media_id varchar(50) [ref: - media.id]
  check_by_name varchar(255)
  check_by_position varchar(255)

  acknowledge_by_signature_media_id varchar(50) [ref: - media.id]
  acknowledge_by_name varchar(255)
  acknowledge_by_position varchar(255)

  noted_by_signature_media_id varchar(50) [ref: - media.id]
  noted_by_name varchar(255)
  noted_by_position varchar(255)

  posted_by_signature_media_id varchar(50) [ref: - media.id]
  posted_by_name varchar(255)
  posted_by_position varchar(255)

  paid_by_signature_media_id varchar(50) [ref: - media.id]
  paid_by_name varchar(255)
  paid_by_position varchar(255)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: loan_transaction.organization_id > organization.id [delete: cascade, update: cascade]
Ref: loan_transaction.branch_id > branch.id [delete:cascade, update:cascade]
Ref: loan_transaction.transaction_batch_id > transaction_batch.id [delete:restrict, update:cascade]
Ref: loan_transaction.comaker_deposit_member_accounting_ledger_id > member_accounting_ledger.id [delete:restrict, update:cascade]
Ref: loan_transaction.comaker_collateral_id > collateral.id [delete:restrict, update:cascade]
Ref: loan_transaction.previous_loan_id - loan_transaction.id [delete:restrict, update:cascade]
Ref: loan_transaction.loan_purpose_id > loan_purpose.id [delete:restrict, update:cascade]
Ref: loan_transaction.loan_status_id > loan_status.id [delete:restrict, update:cascade]

// ðŸ”‘
Table loan_clearance_analysis {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  loan_transaction_id varchar(50)

  regular_deduction_description text
  regular_deduction_amount decimal

  balances_description text
  balances_amount decimal
  balances_count integer

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: loan_clearance_analysis.organization_id > organization.id [delete: cascade, update: cascade]
Ref: loan_clearance_analysis.branch_id > branch.id [delete:cascade, update:cascade]
Ref: loan_clearance_analysis.loan_transaction_id > loan_transaction.id [delete:restrict, update:cascade]

// ðŸ”‘
Table loan_clearance_analysis_institution {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  loan_transaction_id varchar(50)

  name varchar(50)
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: loan_clearance_analysis_institution.organization_id > organization.id [delete: cascade, update: cascade]
Ref: loan_clearance_analysis_institution.branch_id > branch.id [delete:cascade, update:cascade]
Ref: loan_clearance_analysis_institution.loan_transaction_id > loan_transaction.id [delete:restrict, update:cascade]

// ðŸ”‘
Table loan_comaker_member {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  member_profile_id varchar(50)
  loan_transaction_id varchar(50)

  description text // name / collateral
  amount decimal
  months_count integer
  year_count decimal

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: loan_comaker_member.organization_id > organization.id [delete: cascade, update: cascade]
Ref: loan_comaker_member.branch_id > branch.id [delete:cascade, update:cascade]
Ref: loan_comaker_member.loan_transaction_id > loan_transaction.id [delete:restrict, update:cascade]
Ref: loan_comaker_member.member_profile_id > member_profile.id [delete:restrict, update:cascade]

// ðŸ”‘
Table loan_transaction_entry {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  loan_transaction_id varchar(50)

  description text

  credit decimal
  debit decimal

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: loan_transaction_entry.organization_id > organization.id [delete: cascade, update: cascade]
Ref: loan_transaction_entry.branch_id > branch.id [delete:cascade, update:cascade]
Ref: loan_transaction_entry.loan_transaction_id > loan_transaction.id [delete:restrict, update:cascade]

// ðŸ”‘
Table loan_tag {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  loan_transaction_id varchar(50)

  name varchar(50)
  description text
  category tag_category
  color varchar(20)
  icon varchar(20)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: loan_tag.organization_id > organization.id [delete: cascade, update: cascade]
Ref: loan_tag.branch_id > branch.id [delete:cascade, update:cascade]
Ref: loan_tag.loan_transaction_id > loan_transaction.id [delete:cascade, update:cascade]

// ðŸ”‘
Table loan_terms_and_condition_suggested_payment {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  loan_transaction_id varchar(50)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: loan_terms_and_condition_suggested_payment.organization_id > organization.id [delete: cascade, update: cascade]
Ref: loan_terms_and_condition_suggested_payment.branch_id > branch.id [delete:cascade, update:cascade]
Ref: loan_terms_and_condition_suggested_payment.loan_transaction_id > loan_transaction.id [delete:restrict, update:cascade]
// Ref: loan_terms_and_condition_suggested_payment.account_id > account.id [delete:restrict, update:cascade]

// ðŸ”‘
Table loan_terms_and_condition_amount_receipt {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  loan_transaction_id varchar(50) // payment sa account na ito

  account_id varchar(50) // payment sa account na ito
  amount decimal //

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: loan_terms_and_condition_amount_receipt.organization_id > organization.id [delete: cascade, update: cascade]
Ref: loan_terms_and_condition_amount_receipt.branch_id > branch.id [delete:cascade, update:cascade]
Ref: loan_terms_and_condition_amount_receipt.loan_transaction_id > loan_transaction.id [delete:cascade, update:cascade]
Ref: loan_terms_and_condition_amount_receipt.account_id > account.id [delete:cascade, update:cascade]

// NOTE: This is maintenance table that wwwould reflect to all loan entry/application
// ðŸ”‘
Table loan_purpose {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  description text
  icon varchar(255)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestam

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }


}

Ref: loan_purpose.organization_id > organization.id [delete: cascade, update: cascade]
Ref: loan_purpose.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table loan_ledger {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: loan_ledger.organization_id > organization.id [delete: cascade, update: cascade]
Ref: loan_ledger.branch_id > branch.id [delete:cascade, update:cascade]


// ------- LOAN END -------- //


// ---- Maintenance ---- //


enum tag_category {
  accounting
  voucher
  "cash / check voucher"
  "journal voucher"
  "adjustment"
  "transaction"
  "general acconting ledger"
}

// ðŸ”‘
Table tag_template {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  name varchar(50)
  description text
  category tag_category
  color varchar(20)
  icon varchar(20)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: tag_template.organization_id > organization.id [delete: cascade, update: cascade]
Ref: tag_template.branch_id > branch.id [delete:cascade, update:cascade]


// ðŸ”‘
Table holidays {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  entry_date timestamp [not null]
  name varchar(255)
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: holidays.organization_id > organization.id [delete: cascade, update: cascade]
Ref: holidays.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table grocery_computation_sheet {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  scheme_number integer [not null, unique]
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: grocery_computation_sheet.organization_id > organization.id [delete: cascade, update: cascade]
Ref: grocery_computation_sheet.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table grocery_computation_sheet_monthly {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  grocery_computation_sheet_id varchar(50)

  months integer [default: 0]
  interest_rate decimal [default: 0]
  loan_guaranteed_fund_rate decimal [default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: grocery_computation_sheet_monthly.organization_id > organization.id [delete: cascade, update: cascade]
Ref: grocery_computation_sheet_monthly.branch_id > branch.id [delete:cascade, update:cascade]
Ref: grocery_computation_sheet_monthly.grocery_computation_sheet_id > grocery_computation_sheet.id [delete: restrict, update: cascade]

// ðŸ”‘
Table interest_rate_scheme {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  name varchar(255) [unique, not null]
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: interest_rate_scheme.organization_id > organization.id [delete: cascade, update: cascade]
Ref: interest_rate_scheme.branch_id > branch.id [delete:cascade, update:cascade]


// THIS IS THE By terms default in old coop sys
// ðŸ”‘
Table interest_rate_by_terms_header {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  member_classification_interest_rate_id varchar(50)

  header_1 integer [default: 30]
  header_2 integer [default: 60]
  header_3 integer [default: 90]
  header_4 integer [default: 120]
  header_5 integer [default: 150]
  header_6 integer [default: 180]
  header_7 integer [default: 210]
  header_8 integer [default: 240]
  header_9 integer [default: 270]
  header_10 integer [default: 300]
  header_11 integer [default: 330]
  header_12 integer [default: 360]
  header_13 integer [default: 390]
  header_14 integer [default: 410]
  header_15 integer [default: 440]
  header_16 integer [default: 470]
  header_17 integer [default: 500]
  header_18 integer [default: 530]
  header_19 integer [default: 560]
  header_20 integer [default: 590]
  header_21 integer [default: 610]
  header_22 integer [default: 640]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: interest_rate_by_terms_header.organization_id > organization.id [delete: cascade, update: cascade]
Ref: interest_rate_by_terms_header.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table interest_rate_by_term {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  name varchar(255)
  descrition varchar(4028)

  member_classification_interest_rate_id varchar(50)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: interest_rate_by_term.organization_id > organization.id [delete: cascade, update: cascade]
Ref: interest_rate_by_term.branch_id > branch.id [delete:cascade, update:cascade]
Ref: interest_rate_by_term.member_classification_interest_rate_id > member_classification_interest_rate.id

// NOTE: other interest > by percentage > default
// ðŸ”‘
Table interest_rate_percentage {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  name varchar(255)
  description varchar(4028)
  months integer [default: 0]
  interest_rate decimal [default: 0]
  member_classification_interest_rate_id varchar(50)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: interest_rate_percentage.organization_id > organization.id [delete: cascade, update: cascade]
Ref: interest_rate_percentage.branch_id > branch.id [delete:cascade, update:cascade]
Ref: interest_rate_percentage.member_classification_interest_rate_id > member_classification_interest_rate.id

// ðŸ”‘
Table member_type_reference {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  account_id varchar(50)

  member_type_id varchar(50)

  maintaining_balance decimal [default: 0]
  description text
  interest_rate decimal [default: 0]
  minimum_balance decimal [default: 0]
  charges decimal [default: 0]
  active_member_minimum_balance decimal [default: 0]
  active_member_ratio decimal [default: 0]

  other_interest_on_saving_computation_minimum_balance decimal [default:0]
  other_interest_on_saving_computation_interest_rate decimal [default:0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_type_reference.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_type_reference.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_type_reference.account_id - account.id [delete:restrict, update:cascade]
Ref: member_type_reference.member_type_id > member_type.id [delete:restrict, update:cascade]

// ðŸ”‘
Table member_type_reference_by_amount {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  member_type_reference_id varchar(50)

  from decimal [default: 0]
  to decimal [default: 0]
  rate decimal [default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_type_reference_by_amount.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_type_reference_by_amount.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_type_reference_by_amount.member_type_reference_id > member_type_reference.id [delete:cascade, update: cascade]

// ðŸ”‘
Table member_type_reference_interest_rate_by_ultima_membership_date {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  member_type_reference_id varchar(50)

  date_from timestamp
  date_to timestamp
  rate decimal [default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_type_reference_interest_rate_by_ultima_membership_date.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_type_reference_interest_rate_by_ultima_membership_date.branch_id - branch.id [delete:cascade, update:cascade]
Ref: member_type_reference_interest_rate_by_ultima_membership_date.member_type_reference_id > member_type_reference.id [delete:cascade, update: cascade]

// ðŸ”‘
Table member_type_reference_interest_rate_by_ultima_membership_date_per_year {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  member_type_reference_id varchar(50)

  year_from integer
  year_to integer
  rate decimal [default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_type_reference_interest_rate_by_ultima_membership_date_per_year.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_type_reference_interest_rate_by_ultima_membership_date_per_year.branch_id - branch.id [delete:cascade, update:cascade]
Ref: member_type_reference_interest_rate_by_ultima_membership_date_per_year.member_type_reference_id > member_type_reference.id [delete:cascade, update: cascade]

// ðŸ”‘
Table member_deduction_entry {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  member_profile_id varchar(50)
  account_id varchar(50)

  name varchar(255)
  description text

  membership_date timestamp

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: member_deduction_entry.organization_id > organization.id [delete: cascade, update: cascade]
Ref: member_deduction_entry.branch_id > branch.id [delete:cascade, update:cascade]
Ref: member_deduction_entry.member_profile_id > member_profile.id [delete:cascade, update:cascade]
Ref: member_deduction_entry.account_id - account.id [delete:restrict, update:cascade]

// ðŸ”‘
Table collateral {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  icon varchar(255) [ref: - user.id] // THIS IS FROM REACT ICONS, create swithc component

  name varchar(255) [not null]
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: collateral.organization_id > organization.id [delete: cascade, update: cascade]
Ref: collateral.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table post_dated_check {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  member_profile_id varchar(50)
  full_name varchar(255)
  passbook_number varchar(255)

  // Check info
  check_number varchar(255)
  check_date timestamp
  clear_days integer
  date_cleared timestamp
  bank_id varchar(50)
  amount decimal [default: 0]

  // OR info
  reference_number varchar(255)
  official_receipt_date timestamp
  collateral_user_id varchar(50)

  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: post_dated_check.organization_id > organization.id [delete: cascade, update: cascade]
Ref: post_dated_check.branch_id > branch.id [delete:cascade, update:cascade]
Ref: post_dated_check.member_profile_id > member_profile.id [delete:restrict, update:cascade]
Ref: post_dated_check.bank_id > bank.id [delete:restrict, update:cascade]
Ref: post_dated_check.collateral_user_id > user.id [delete:restrict, update:cascade]

// ---- Maintenance ---- //

// SUBSCRIPTION FEATURE START (MEMBER)


enum subscription_plan_type {
  weekly
  monthly
  quarterly
  yearly
}

// ðŸ”‘
Table subscription {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  account_id varchar(50)
  member_profile_id varchar(50)
  subscription_plan_id varchar(50)

  started_at timestamp
  ended_at timestamp

  remarks text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: subscription.organization_id > organization.id [delete: cascade, update: cascade]
Ref: subscription.account_id - account.id [delete:restrict, update:cascade]
Ref: subscription.member_profile_id > member_profile.id [delete:restrict, update:cascade]
Ref: subscription.subscription_plan_id > subscription_plan.id [delete:restrict, update:cascade]
Ref: subscription.branch_id > branch.id [delete:cascade, update:cascade]

// SUBSCRIPTION FEATURE END


// ---- TIME DEP START ---- //

// TIME DEP Maintenance Table
// Maintenance > TD Type Table
// ðŸ”‘
Table time_deposit_type {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  time_deposit_computation_header_id varchar(50)

  name varchar(255) [not null, unique]
  description text

  pre_mature integer [default: 0]
  pre_mature_rate decimal [default: 0]
  excess decimal [default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: time_deposit_type.organization_id > organization.id [delete: cascade, update: cascade]
Ref: time_deposit_type.branch_id > branch.id [delete:cascade, update:cascade]
Ref: time_deposit_type.time_deposit_computation_header_id - time_deposit_computation_header.id


// ðŸ”‘
Table time_deposit_computation_header {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  header_1 integer [default: 30]
  header_2 integer [default: 60]
  header_3 integer [default: 90]
  header_4 integer [default: 120]
  header_5 integer [default: 150]
  header_6 integer [default: 180]
  header_7 integer [default: 210]
  header_8 integer [default: 240]
  header_9 integer [default: 300]
  header_10 integer [default: 330]
  header_11 integer [default: 360]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: time_deposit_computation_header.organization_id > organization.id [delete: cascade, update: cascade]
Ref: time_deposit_computation_header.branch_id > branch.id [delete:cascade, update:cascade]

// ðŸ”‘
Table time_deposit_computation {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  time_deposit_type_id varchar(50)

  mininimum_amount decimal [default: 0]
  maximum_amount decimal [default: 0]

  header_1 decimal [default: 0]
  header_2 decimal [default: 0]
  header_3 decimal [default: 0]
  header_4 decimal [default: 0]
  header_5 decimal [default: 0]
  header_6 decimal [default: 0]
  header_7 decimal [default: 0]
  header_8 decimal [default: 0]
  header_9 decimal [default: 0]
  header_10 decimal [default: 0]
  header_11 decimal [default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: time_deposit_computation.organization_id > organization.id [delete: cascade, update: cascade]
Ref: time_deposit_computation.branch_id > branch.id [delete:cascade, update:cascade]
Ref: time_deposit_computation.time_deposit_type_id > time_deposit_type.id

// ðŸ”‘
Table time_deposit_computation_pre_mature {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  time_deposit_type_id varchar(50)

  terms integer [default: 0]
  from integer [default: 0]
  to integer [default: 0]
  rate decimal [default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: time_deposit_computation_pre_mature.organization_id > organization.id [delete: cascade, update: cascade]
Ref: time_deposit_computation_pre_mature.branch_id > branch.id [delete:cascade, update:cascade]
Ref: time_deposit_computation_pre_mature.time_deposit_type_id > time_deposit_type.id [delete:restrict, update:cascade]

// For deposit for paid up shared capital
// ðŸ”‘
Table charges_rate_scheme {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  charges_rate_by_term_header_id varchar(50)
  charges_rate_member_type_mode_of_payment_id varchar(50)

  name varchar(255) [not null, unique]
  description text [not null, unique]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: charges_rate_scheme.organization_id > organization.id [delete: cascade, update: cascade]
Ref: charges_rate_scheme.branch_id > branch.id [delete:cascade, update:cascade]
Ref: charges_rate_scheme.charges_rate_by_term_header_id - charges_rate_by_term_header.id
Ref: charges_rate_scheme.charges_rate_member_type_mode_of_payment_id - charges_rate_member_type_mode_of_payment.id

//NOTE: Dati 2 lang account, ngayon many
// ðŸ”‘
Table charges_rate_scheme_account {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  charges_rate_scheme_id varchar(50)
  account_id varchar(50)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: charges_rate_scheme_account.organization_id > organization.id [delete: cascade, update: cascade]
Ref: charges_rate_scheme_account.branch_id > branch.id [delete:cascade, update:cascade]
Ref: charges_rate_scheme_account.account_id - account.id [delete:restrict, update:cascade]
Ref: charges_rate_scheme_account.charges_rate_scheme_id > charges_rate_scheme.id [delete:restrict, update:cascade]

// NOTE: Maintenance Table > Other charges > Eto yung By Rate or amount by range button
// ðŸ”‘
Table charges_rate_by_range_or_minimum_amount {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  charges_rate_scheme_id archar(50)

  from decimal [default: 0]
  to decimal [default: 0]
  charge decimal [default: 0]
  amount decimal [default: 0]
  minimum_amount decimal [default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: charges_rate_by_range_or_minimum_amount.organization_id > organization.id [delete: cascade, update: cascade]
Ref: charges_rate_by_range_or_minimum_amount.branch_id > branch.id [delete:cascade, update:cascade]
Ref: charges_rate_by_range_or_minimum_amount.charges_rate_scheme_id > charges_rate_scheme.id [delete:restrict, update:cascade]

// ðŸ”‘
Table charges_rate_by_term_header {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  header_1 integer [default: 0]
  header_2 integer [default: 0]
  header_3 integer [default: 0]
  header_4 integer [default: 0]
  header_5 integer [default: 0]
  header_6 integer [default: 0]
  header_7 integer [default: 0]
  header_8 integer [default: 0]
  header_9 integer [default: 0]
  header_10 integer [default: 0]
  header_11 integer [default: 0]
  header_12 integer [default: 0]
  header_13 integer [default: 0]
  header_14 integer [default: 0]
  header_15 integer [default: 0]
  header_16 integer [default: 0]
  header_17 integer [default: 0]
  header_18 integer [default: 0]
  header_19 integer [default: 0]
  header_20 integer [default: 0]
  header_21 integer [default: 0]
  header_22 integer [default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: charges_rate_by_term_header.organization_id > organization.id [delete: cascade, update: cascade]
Ref: charges_rate_by_term_header.branch_id > branch.id [delete:cascade, update:cascade]

enum charges_mode_of_payment_type {
  daily
  weekly
  monthly
  "semi-monthly"
  quarterly
  "semi-annual"
  lumpsum
}

// ðŸ”‘
Table charges_rate_by_term {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  charges_rate_scheme_id varchar(50)

  name varchar(255)
  description text
  mode_of_payment charges_mode_of_payment_type [default: "monthly"]

  rate_1 decimal [default: 0]
  rate_2 decimal [default: 0]
  rate_3 decimal [default: 0]
  rate_4 decimal [default: 0]
  rate_5 decimal [default: 0]
  rate_6 decimal [default: 0]
  rate_7 decimal [default: 0]
  rate_8 decimal [default: 0]
  rate_9 decimal [default: 0]
  rate_10 decimal [default: 0]
  rate_11 decimal [default: 0]
  rate_12 decimal [default: 0]
  rate_13 decimal [default: 0]
  rate_14 decimal [default: 0]
  rate_15 decimal [default: 0]
  rate_16 decimal [default: 0]
  rate_17 decimal [default: 0]
  rate_18 decimal [default: 0]
  rate_19 decimal [default: 0]
  rate_20 decimal [default: 0]
  rate_21 decimal [default: 0]
  rate_22 decimal [default: 0]

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: charges_rate_by_term.organization_id > organization.id [delete: cascade, update: cascade]
Ref: charges_rate_by_term.branch_id > branch.id [delete:cascade, update:cascade]
Ref: charges_rate_by_term.charges_rate_scheme_id > charges_rate_scheme.id

enum charges_rate_member_type_enum {
  all
  daily
  weekly
  monthly
  "semi-monthly"
  "quarterly"
  "semi-annual"
  lumpsum
}

// ðŸ”‘
Table charges_rate_member_type_mode_of_payment {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  member_type_id varchar(50)

  mode_of_payment charges_rate_member_type_enum [default: 'all']

  name varchar(255)
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: charges_rate_member_type_mode_of_payment.organization_id > organization.id [delete: cascade, update: cascade]
Ref: charges_rate_member_type_mode_of_payment.branch_id > branch.id [delete:cascade, update:cascade]
Ref: charges_rate_member_type_mode_of_payment.member_type_id - member_type.id [delete:restrict, update:cascade]


// ---- TIME DEP END ---- //

// ---- ACCOUNTING ENTRY START ---- //

// DIREKTANG ADJUST TO ACCOUNTING LEDGER
// ðŸ”‘
Table adjustment_entry {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  signature_media_id varchar(50) [ref: - media.id]
  account_id varchar(50)
  member_profile_id varchar(50) // autopopulate here if the journal_voucher.member_profile_id has id
  employee_user_id varchar(50)
  payment_type_id varchar(50)
  type_of_payment_type payment_type

  description text
  reference_number varchar(255)
  entry_date date

  debit decimal
  credit decimal

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: adjustment_entry.organization_id > organization.id [delete: cascade, update: cascade]
Ref: adjustment_entry.branch_id > branch.id [delete:cascade, update:cascade]
Ref: adjustment_entry.employee_user_id > user.id [delete:restrict, update:cascade]
Ref: adjustment_entry.member_profile_id > member_profile.id [delete:restrict, update:cascade]
Ref: adjustment_entry.account_id > account.id [delete:restrict, update:cascade]
Ref: adjustment_entry.payment_type_id > payment_type.id [delete:restrict, update:cascade]

// ðŸ”‘
Table adjustment_entry_tag {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  adjustment_entry_id varchar(50)

  name varchar(50)
  description text
  category tag_category
  color varchar(20)
  icon varchar(20)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: adjustment_entry_tag.organization_id > organization.id [delete: cascade, update: cascade]
Ref: adjustment_entry_tag.branch_id > branch.id [delete:cascade, update:cascade]
Ref: adjustment_entry_tag.adjustment_entry_id > adjustment_entry.id [delete:cascade, update:cascade]

// ACCOUNTING ENTRY CV, JV, ADJ
// ðŸ”‘
Table voucher_pay_to {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  name varchar(255)
  media_id varchar(50)
  description varchar(255)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: voucher_pay_to.organization_id > organization.id [delete: cascade, update: cascade]
Ref: voucher_pay_to.branch_id > branch.id [delete:cascade, update:cascade]
Ref: voucher_pay_to.media_id - media.id [delete:restrict, update:cascade]

enum cash_check_voucher_status {
  pending
  printed
  approved
  released
}

// ðŸ”‘
Table cash_check_voucher {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  employee_user_id varchar(50)
  transaction_batch_id varchar(50)
  printed_by_user_id varchar(50)
  approved_by_user_id varchar(50)
  released_by_user_id varchar(50)

  pay_to varchar(255)

  status cash_check_voucher_status
  description text //particulars to
  cash_voucher_number varchar(255) [unique]

  total_debit decimal
  total_credit decimal

  print_count integer

  printed_date timestamp
  approved_date timestamp
  released_date timestamp // everytime na marerelease magkakaron sa transaction batch CDV History at CASH Voucher sa LESS


  // SIGNATURES
  approved_by_signature_media_id varchar(50) [ref: - media.id]
  approved_by_name varchar(255)
  approved_by_position varchar(255)

  prepared_by_signature_media_id varchar(50) [ref: - media.id]
  prepared_by_name varchar(255)
  prepared_by_position varchar(255)

  certified_by_signature_media_id varchar(50) [ref: - media.id]
  certified_by_name varchar(255)
  certified_by_position varchar(255)

  verified_by_signature_media_id varchar(50) [ref: - media.id]
  verified_by_name varchar(255)
  verified_by_position varchar(255)

  check_by_signature_media_id varchar(50) [ref: - media.id]
  check_by_name varchar(255)
  check_by_position varchar(255)

  acknowledge_by_signature_media_id varchar(50) [ref: - media.id]
  acknowledge_by_name varchar(255)
  acknowledge_by_position varchar(255)

  noted_by_signature_media_id varchar(50) [ref: - media.id]
  noted_by_name varchar(255)
  noted_by_position varchar(255)

  posted_by_signature_media_id varchar(50) [ref: - media.id]
  posted_by_name varchar(255)
  posted_by_position varchar(255)

  paid_by_signature_media_id varchar(50) [ref: - media.id]
  paid_by_name varchar(255)
  paid_by_position varchar(255)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: cash_check_voucher.organization_id > organization.id [delete: cascade, update: cascade]
Ref: cash_check_voucher.branch_id > branch.id [delete:cascade, update:cascade]
Ref: cash_check_voucher.employee_user_id > user.id [delete:restrict, update:cascade]
Ref: cash_check_voucher.printed_by_user_id > user.id [delete:restrict, update:cascade]
Ref: cash_check_voucher.transaction_batch_id > transaction_batch.id [delete:restrict, update:cascade]
Ref: cash_check_voucher.approved_by_user_id > user.id [delete:restrict, update:cascade]
Ref: cash_check_voucher.released_by_user_id > user.id [delete:restrict, update:cascade]

// ðŸ”‘
Table cash_check_voucher_tag {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  cash_check_voucher_id varchar(50)

  name varchar(50)
  description text
  category tag_category
  color varchar(20)
  icon varchar(20)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: cash_check_voucher_tag.organization_id > organization.id [delete: cascade, update: cascade]
Ref: cash_check_voucher_tag.branch_id > branch.id [delete:cascade, update:cascade]
Ref: cash_check_voucher_tag.cash_check_voucher_id > cash_check_voucher.id [delete:cascade, update:cascade]

// ðŸ”‘
Table cash_check_voucher_entry {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  account_id varchar(50)
  employee_user_id varchar(50)
  transaction_batch_id varchar(50)
  cash_check_voucher_id varchar(50)

  debit decimal
  credit decimal
  description text

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: cash_check_voucher_entry.organization_id > organization.id [delete: cascade, update: cascade]
Ref: cash_check_voucher_entry.branch_id > branch.id [delete:cascade, update:cascade]
Ref: cash_check_voucher_entry.employee_user_id > user.id [delete:restrict, update:cascade]
Ref: cash_check_voucher_entry.cash_check_voucher_id > cash_check_voucher.id [delete:restrict, update:cascade]
Ref: cash_check_voucher_entry.transaction_batch_id > transaction_batch.id [delete:restrict, update:cascade]
Ref: cash_check_voucher_entry.account_id > account.id [delete:restrict, update:cascade]

// ðŸ”‘
Table cash_check_voucher_disbursement_entry {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  printed_by_user_id varchar(50)
  approved_by_user_id varchar(50)
  released_by_user_id varchar(50)

  employee_user_id varchar(50)
  account_id varchar(50)
  cash_check_voucher_id varchar(50)
  transaction_batch_id varchar(50)

  pay_to varchar(255)
  cash_check_voucher_number varchar(255)

  status cash_check_voucher_status
  description text //particulars to

  amount decimal

  printed_date timestamp
  approved_date timestamp
  released_date timestamp // everytime na marerelease magkakaron sa transaction batch CDV History at CASH Voucher sa LESS

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: cash_check_voucher_disbursement_entry.organization_id > organization.id [delete: cascade, update: cascade]
Ref: cash_check_voucher_disbursement_entry.branch_id > branch.id [delete:cascade, update:cascade]
Ref: cash_check_voucher_disbursement_entry.employee_user_id > user.id [delete:restrict, update:cascade]
Ref: cash_check_voucher_disbursement_entry.account_id > account.id [delete:restrict, update:cascade]
Ref: cash_check_voucher_disbursement_entry.transaction_batch_id > transaction_batch.id [delete:restrict, update:cascade]
Ref: cash_check_voucher_disbursement_entry.cash_check_voucher_id > cash_check_voucher.id [delete:restrict, update:cascade]

// ðŸ”‘
Table journal_voucher {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  employee_user_id varchar(50)
  member_profile_id varchar(50) // this will be use to populate the journal voucher entry. member_profile_id entries

  printed_by_user_id varchar(50)
  approved_by_user_id varchar(50)
  released_by_user_id varchar(50)

  total_debit decimal
  total_credit decimal

  print_count integer
  description text

  printed_date timestamp
  approved_date timestamp
  released_date timestamp // everytime na marerelease magkakaron sa transaction batch CDV History at CASH Voucher sa LESS

  // SIGNATURES
  approved_by_signature_media_id varchar(50) [ref: - media.id]
  approved_by_name varchar(255)
  approved_by_position varchar(255)

  prepared_by_signature_media_id varchar(50) [ref: - media.id]
  prepared_by_name varchar(255)
  prepared_by_position varchar(255)

  certified_by_signature_media_id varchar(50) [ref: - media.id]
  certified_by_name varchar(255)
  certified_by_position varchar(255)

  verified_by_signature_media_id varchar(50) [ref: - media.id]
  verified_by_name varchar(255)
  verified_by_position varchar(255)

  check_by_signature_media_id varchar(50) [ref: - media.id]
  check_by_name varchar(255)
  check_by_position varchar(255)

  acknowledge_by_signature_media_id varchar(50) [ref: - media.id]
  acknowledge_by_name varchar(255)
  acknowledge_by_position varchar(255)

  noted_by_signature_media_id varchar(50) [ref: - media.id]
  noted_by_name varchar(255)
  noted_by_position varchar(255)

  posted_by_signature_media_id varchar(50) [ref: - media.id]
  posted_by_name varchar(255)
  posted_by_position varchar(255)

  paid_by_signature_media_id varchar(50) [ref: - media.id]
  paid_by_name varchar(255)
  paid_by_position varchar(255)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: journal_voucher.organization_id > organization.id [delete: cascade, update: cascade]
Ref: journal_voucher.branch_id > branch.id [delete:cascade, update:cascade]
Ref: journal_voucher.employee_user_id > user.id [delete:restrict, update:cascade]
Ref: journal_voucher.member_profile_id > member_profile.id [delete:restrict, update:cascade]

// ðŸ”‘
Table journal_voucher_tag {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  journal_voucher_id varchar(50)

  name varchar(50)
  description text
  category tag_category
  color varchar(20)
  icon varchar(20)

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: journal_voucher_tag.organization_id > organization.id [delete: cascade, update: cascade]
Ref: journal_voucher_tag.branch_id > branch.id [delete:cascade, update:cascade]
Ref: journal_voucher_tag.journal_voucher_id > journal_voucher.id [delete:cascade, update:cascade]

// DAPAT NAGREREFLECT SA GENERAL ACCOUNTING LEDGER
// ðŸ”‘
Table journal_voucher_entry {
  id varchar(50) [primary key, unique, default: `uuid_generate_v4()`]

  organization_id varchar(50)
  branch_id varchar(50)

  created_by_id varchar(50) [ref: - user.id]
  updated_by_id varchar(50) [ref: - user.id]
  deleted_by_id varchar(50) [ref: - user.id]

  account_id varchar(50)
  member_profile_id varchar(50) // autopopulate here if the journal_voucher.member_profile_id has id
  employee_user_id varchar(50)
  journal_voucher_id varchar(50)

  description text
  debit decimal
  credit decimal

  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  deleted_at timestamp

  indexes {
    (organization_id, branch_id) [name: 'organization_branch']
  }

}

Ref: journal_voucher_entry.organization_id > organization.id [delete: cascade, update: cascade]
Ref: journal_voucher_entry.branch_id > branch.id [delete:cascade, update:cascade]
Ref: journal_voucher_entry.employee_user_id > user.id [delete:restrict, update:cascade]
Ref: journal_voucher_entry.journal_voucher_id > journal_voucher.id [delete:restrict, update:cascade]
Ref: journal_voucher_entry.member_profile_id > member_profile.id [delete:restrict, update:cascade]
Ref: journal_voucher_entry.account_id > account.id [delete:restrict, update:cascade]

// ---- ACCOUNTING ENTRY END ---- //
